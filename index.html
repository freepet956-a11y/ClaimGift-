<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Grow A Garden — Replica (HTML)</title>
<style>
  :root{
    --bg1:#e6f7ff;
    --bg2:#fff6f6;
    --accent:#4caf50;
    --pot:#6b3f2f;
    --soil:#3b2b20;
    --text:#17202a;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background: radial-gradient(circle at 20% 10%, #ffffff 0%, rgba(255,255,255,0.6) 20%, transparent 40%),
                linear-gradient(180deg, #e6f7ff 0%, #fff6f6 60%);
    color:var(--text);
    display:flex;
    align-items:center;
    justify-content:center;
    -webkit-font-smoothing:antialiased;
    user-select:none;
    -webkit-tap-highlight-color: transparent;
    padding:30px;
  }

  /* Page shell */
  .wrap{
    width:100%;
    max-width:920px;
    background: linear-gradient(180deg, rgba(255,255,255,0.9), rgba(255,255,255,0.6));
    border-radius:18px;
    box-shadow: 0 10px 40px rgba(22,28,37,0.12);
    padding:28px;
    display:grid;
    grid-template-columns: 1fr 360px;
    gap:20px;
    align-items:center;
  }

  header{
    grid-column: 1 / -1;
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:16px;
    margin-bottom:4px;
  }
  header h1{
    margin:0;
    font-size:20px;
    letter-spacing:2px;
    color:#0f1720;
  }
  header .sub{
    color:#6b7280;
    font-size:13px;
  }

  /* Scene */
  .scene{
    background: linear-gradient(180deg, rgba(255,255,255,0.35), rgba(255,255,255,0.1));
    border-radius:12px;
    padding:26px;
    min-height:420px;
    position:relative;
    display:flex;
    align-items:flex-end;
    justify-content:center;
    overflow:hidden;
  }
  .ground{
    width:100%;
    max-width:520px;
    height:260px;
    position:relative;
    display:flex;
    align-items:flex-end;
    justify-content:center;
  }

  /* Pot */
  .pot{
    width:220px;
    height:90px;
    background: linear-gradient(180deg,#a16207,#7f4b20);
    border-radius:18px 18px 14px 14px;
    position:relative;
    box-shadow: inset 0 -12px 22px rgba(0,0,0,0.18);
    display:flex;
    align-items:flex-end;
    justify-content:center;
  }
  .pot:before{
    content:"";
    position:absolute;
    left:10%;
    right:10%;
    top:-18px;
    height:22px;
    background: linear-gradient(180deg,#ffd19f,#ffb36b);
    border-radius:10px;
    filter:blur(0.2px);
    transform:translateY(-6px);
    opacity:0.95;
  }

  .soil{
    width:86%;
    height:32px;
    background: linear-gradient(180deg, #40302a, #2c1f18);
    border-radius:8px;
    margin-bottom:10px;
    box-shadow: 0 6px 8px rgba(0,0,0,0.25);
    position:relative;
    overflow:hidden;
  }

  /* Plant container */
  .plant-wrap{
    position:absolute;
    bottom:62px;
    display:flex;
    align-items:flex-end;
    justify-content:center;
    width:100%;
    pointer-events:none; /* let pointer on button/pot area */
  }

  /* The adjustable plant itself */
  .plant{
    --g: 0; /* 0..1 */
    width:140px;
    transform-origin: 50% 100%;
    transition: transform 120ms linear;
    pointer-events:auto;
    touch-action:none;
    cursor:pointer;
  }

  /* Stem */
  .stem{
    width:8px;
    height:120px;
    margin:0 auto;
    background: linear-gradient(180deg,#95d36a,#4a8b33);
    border-radius:8px;
    transform-origin: 50% 100%;
    transform: translateY(calc(40px * (1 - var(--g)))) scaleY(calc(0.25 + 0.75 * var(--g)));
    transition: transform 120ms linear;
    box-shadow: 0 6px 12px rgba(0,0,0,0.08);
  }

  /* Leaves */
  .leaf{
    position:absolute;
    width:60px;
    height:36px;
    background: linear-gradient(180deg,#67c36a,#1f7a35);
    border-radius:34px 12px 12px 34px;
    top:calc(100% - 60px);
    opacity: calc(0.2 + 0.9 * var(--g));
    transform-origin: 100% 50%;
    transition: transform 180ms cubic-bezier(.2,.9,.2,1), opacity 140ms linear;
    filter: drop-shadow(0 6px 8px rgba(0,0,0,0.08));
  }
  .leaf.left{
    left: calc(50% - 72px);
    transform: rotate(calc(-60deg * (1 - var(--g))));
  }
  .leaf.right{
    right: calc(50% - 72px);
    transform-origin: 0% 50%;
    border-radius:12px 34px 34px 12px;
    transform: rotate(calc(60deg * (1 - var(--g))));
  }

  /* Bud + petals (hidden until bloom) */
  .bud{
    width:34px;
    height:34px;
    background: radial-gradient(circle at 40% 30%, #fff4f6 0%, #ffd3df 28%, #ff7fb1 70%);
    border-radius:50%;
    margin:-24px auto 0;
    transform-origin:center center;
    transform: scale(calc(0.4 + 0.6 * var(--g)));
    transition: transform 120ms linear;
    box-shadow: 0 6px 20px rgba(255,98,170,0.12), inset 0 -6px 12px rgba(0,0,0,0.08);
    z-index:5;
    position:relative;
  }

  .petals{
    position:absolute;
    left:50%;
    top:50%;
    transform: translate(-50%,-50%) scale(0.6);
    width:150px;
    height:150px;
    pointer-events:none;
    opacity:0;
  }
  .petal{
    --r:0deg;
    position:absolute;
    left:50%;
    top:50%;
    width:42px;
    height:56px;
    border-radius:50% 50% 50% 50%;
    background: radial-gradient(circle at 30% 20%, #fffaf2 0%, #ffe7b6 28%, #ff9f18 70%);
    transform-origin: 50% 85%;
    transform: rotate(var(--r)) translateY(calc(-20px)) scale(0.4);
    opacity:0.0;
    box-shadow: 0 6px 16px rgba(0,0,0,0.12);
  }

  .petal.p1{ --r: -8deg; left:50%; top:22%;}
  .petal.p2{ --r: 40deg; left:66%; top:30%;}
  .petal.p3{ --r: 90deg; left:74%; top:50%;}
  .petal.p4{ --r: -40deg; left:34%; top:30%;}
  .petal.p5{ --r: -90deg; left:26%; top:50%;}
  .petal.p6{ --r: 0deg; left:50%; top:10%;}

  /* bloom state */
  .plant.bloom .petals{
    opacity:1;
    transform: translate(-50%,-50%) scale(1);
    transition: transform 420ms cubic-bezier(.16,.85,.28,1), opacity 220ms linear;
  }
  .plant.bloom .petal{
    animation: petalOut 900ms cubic-bezier(.16,.85,.28,1) forwards;
  }
  .plant.bloom .petal.p1{ animation-delay: 40ms; }
  .plant.bloom .petal.p2{ animation-delay: 80ms; }
  .plant.bloom .petal.p3{ animation-delay: 120ms; }
  .plant.bloom .petal.p4{ animation-delay: 160ms; }
  .plant.bloom .petal.p5{ animation-delay: 200ms; }
  .plant.bloom .petal.p6{ animation-delay: 240ms; }

  @keyframes petalOut{
    0%{ transform: rotate(var(--r)) translateY(-14px) scale(0.4); opacity:0; filter:blur(0px); }
    40%{ transform: rotate(calc(var(--r) * 1.2)) translateY(-34px) scale(1.05); opacity:1; filter:blur(0); }
    100%{ transform: rotate(calc(var(--r) * 1.45)) translateY(-64px) scale(0.95); opacity:1; filter:blur(0); }
  }

  /* Progress + controls column */
  .side{
    display:flex;
    flex-direction:column;
    gap:16px;
    padding:8px 4px;
  }
  .card{
    background: rgba(255,255,255,0.7);
    padding:12px;
    border-radius:12px;
    box-shadow: 0 6px 18px rgba(16,24,40,0.06);
  }

  .action{
    display:flex;
    gap:10px;
    align-items:center;
    justify-content:space-between;
  }
  .grow-btn{
    flex:1;
    background: linear-gradient(180deg,#66bb6a,#2e7d32);
    border:0;
    color:white;
    padding:14px 16px;
    border-radius:10px;
    font-weight:600;
    font-size:15px;
    cursor:pointer;
    box-shadow: 0 8px 18px rgba(46,125,50,0.15);
  }
  .grow-btn:active{ transform: translateY(1px) scale(0.998) }

  .progress-wrap{
    width:100%;
    background: linear-gradient(180deg,#f1f1f1,#fff);
    border-radius:10px;
    padding:10px;
    display:flex;
    gap:10px;
    align-items:center;
  }
  .bar{
    height:14px;
    width:100%;
    background:linear-gradient(90deg,#eee,#f9f9f9);
    border-radius:8px;
    overflow:hidden;
    box-shadow: inset 0 1px 0 rgba(255,255,255,0.6);
  }
  .bar > .fill{
    height:100%;
    width:0%;
    background: linear-gradient(90deg,#ffb6d5,#ff6fa0);
    border-radius:8px;
    transition: width 120ms linear;
    box-shadow: inset 0 -4px 10px rgba(255,255,255,0.12);
  }
  .status{
    min-width:86px;
    text-align:center;
    font-weight:600;
    color:#334155;
  }

  .hint{ font-size:13px; color:#475569; }

  /* Canvas overlay for sparks */
  #sparks{
    position:absolute;
    left:0; top:0;
    width:100%;
    height:100%;
    pointer-events:none;
    z-index:30;
  }

  /* small footer */
  .footer{
    grid-column:1 / -1;
    text-align:right;
    font-size:12px;
    color:#6b7280;
  }

  /* responsive */
  @media (max-width:880px){
    .wrap{ grid-template-columns: 1fr; padding:16px;}
    .side{ order:2 }
    .scene{ order:1; min-height:360px}
  }
</style>
</head>
<body>
  <div class="wrap" role="main" aria-label="Grow A Garden replica">
    <header>
      <h1>GROW A GARDEN</h1>
      <div class="sub">Nhấn/giữ để cây lớn và nở hoa — Replica (HTML)</div>
    </header>

    <div class="scene card" id="scene">
      <canvas id="sparks"></canvas>

      <div class="ground" aria-hidden="true">
        <div class="pot" id="pot">
          <div class="soil"></div>
        </div>

        <div class="plant-wrap">
          <div class="plant" id="plant" role="button" tabindex="0" aria-label="Cây">
            <div class="stem"></div>
            <div class="leaf left"></div>
            <div class="leaf right"></div>
            <div class="bud"></div>

            <div class="petals" aria-hidden="true">
              <div class="petal p1"></div>
              <div class="petal p2"></div>
              <div class="petal p3"></div>
              <div class="petal p4"></div>
              <div class="petal p5"></div>
              <div class="petal p6"></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="side">
      <div class="card">
        <div class="action">
          <button id="growBtn" class="grow-btn" aria-pressed="false">Nhấn / Giữ để nở</button>
        </div>
        <div style="height:12px"></div>
        <div class="progress-wrap">
          <div class="bar" aria-hidden="true"><div class="fill" id="fill"></div></div>
          <div class="status" id="status">Seed</div>
        </div>
        <div style="height:8px"></div>
        <div class="hint">Nhấn (click) tăng ít, giữ (hold) tăng nhanh — thả ra để dừng. Khi 100%: bông nở + hiệu ứng tia sáng.</div>
      </div>

      <div class="card" style="display:flex;flex-direction:column;gap:8px">
        <div style="font-weight:700">Trạng thái cây</div>
        <div>- 0%–10%: Hạt</div>
        <div>- 10%–40%: Mầm</div>
        <div>- 40%–80%: Cây non</div>
        <div>- 80%–99%: Nụ</div>
        <div>- 100%: Nở rộ 🎉</div>
      </div>

      <div class="card footer">Replica HTML — sẵn sàng deploy lên Vercel</div>
    </div>
  </div>

<script>
/*
  Logic:
  - growth: 0..100
  - click adds small step
  - hold increases growth continuously
  - when growth >=100 -> bloom
  - support mouse/pointer/touch
  - spark particle burst on bloom
*/

const plant = document.getElementById('plant');
const fill = document.getElementById('fill');
const statusEl = document.getElementById('status');
const growBtn = document.getElementById('growBtn');
const sparksCanvas = document.getElementById('sparks');
const scene = document.getElementById('scene');

let growth = 0; // 0..100
let holding = false;
let bloomed = false;
let lastTime = null;
let audioCtx = null;

// particle system
const ctx = sparksCanvas.getContext('2d');
let particles = [];

function resizeCanvas(){
  sparksCanvas.width = scene.clientWidth;
  sparksCanvas.height = scene.clientHeight;
}
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

function clamp(v, a=0,b=100){ return Math.max(a, Math.min(b, v)); }
function setGrowth(v){
  growth = clamp(v);
  const gnorm = growth/100;
  // update CSS var for plant
  plant.style.setProperty('--g', (gnorm).toString());
  // progress bar
  fill.style.width = growth + '%';
  // textual state
  if(growth < 10) statusEl.textContent = 'Seed';
  else if(growth < 40) statusEl.textContent = 'Sprout';
  else if(growth < 80) statusEl.textContent = 'Young';
  else if(growth < 100) statusEl.textContent = 'Bud';
  else statusEl.textContent = 'Bloomed';
}

function bloom(){
  if(bloomed) return;
  bloomed = true;
  growth = 100;
  setGrowth(100);
  plant.classList.add('bloom');
  // particle burst from bud position
  const rect = scene.getBoundingClientRect();
  // determine bud center
  const bud = plant.querySelector('.bud');
  const bRect = bud.getBoundingClientRect();
  const cx = bRect.left - rect.left + bRect.width/2;
  const cy = bRect.top - rect.top + bRect.height/2;
  spawnBurst(cx, cy, 46);
  playPopSound();
}

// sound simple impulse using WebAudio (optional)
function playPopSound(){
  try{
    if(!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    const o = audioCtx.createOscillator();
    const g = audioCtx.createGain();
    o.type = 'sine';
    o.frequency.setValueAtTime(880, audioCtx.currentTime);
    o.frequency.exponentialRampToValueAtTime(240, audioCtx.currentTime + 0.25);
    g.gain.setValueAtTime(0.0001, audioCtx.currentTime);
    g.gain.exponentialRampToValueAtTime(0.12, audioCtx.currentTime + 0.01);
    g.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + 0.28);
    o.connect(g); g.connect(audioCtx.destination);
    o.start();
    o.stop(audioCtx.currentTime + 0.3);
  }catch(e){ /*ignore*/ }
}


// particle functions
function spawnBurst(x,y,count){
  for(let i=0;i<count;i++){
    const angle = Math.random()*Math.PI*2;
    const speed = 1.8 + Math.random()*3.6;
    const vx = Math.cos(angle)*speed;
    const vy = Math.sin(angle)*speed - (0.6 + Math.random()*1.6);
    particles.push({
      x: x, y: y,
      vx: vx, vy: vy,
      life: 800 + Math.random()*800,
      born: performance.now(),
      size: 3 + Math.random()*6,
      color: randomColor()
    });
  }
}
function randomColor(){
  const palette = ['#FFD1E8','#FFB6D5','#FF9FB3','#FFF4C9','#FFF0D1','#FFDE8C'];
  return palette[Math.floor(Math.random()*palette.length)];
}

function updateParticles(now){
  // remove dead
  particles = particles.filter(p => (now - p.born) < p.life);
  // integrate
  for(const p of particles){
    const t = (now - p.born)/1000;
    p.vy += 0.002 * 60; // gravity-ish
    p.x += p.vx * 1.6;
    p.y += p.vy * 1.6;
  }
}

function renderParticles(){
  ctx.clearRect(0,0,sparksCanvas.width,sparksCanvas.height);
  for(const p of particles){
    const age = (performance.now() - p.born)/p.life;
    const alpha = 1 - Math.min(1, age);
    ctx.beginPath();
    ctx.fillStyle = hexWithAlpha(p.color, alpha);
    ctx.arc(p.x, p.y, p.size * (0.6 + 0.8*(1 - age)), 0, Math.PI*2);
    ctx.fill();
  }
}

function hexWithAlpha(hex, a){
  // hex like #rrggbb
  const r = parseInt(hex.slice(1,3),16);
  const g = parseInt(hex.slice(3,5),16);
  const b = parseInt(hex.slice(5,7),16);
  return `rgba(${r},${g},${b},${a})`;
}

// animation loop for growth + particles
function loop(time){
  if(lastTime === null) lastTime = time;
  const dt = time - lastTime;
  lastTime = time;

  // holding increases growth
  if(holding && !bloomed){
    // rate: ~26% per second -> 0.026 per ms
    const add = dt * 0.026;
    setGrowth(growth + add);
  }

  if(growth >= 100 && !bloomed){
    bloom();
  }

  // update particles
  updateParticles(time);
  renderParticles();

  requestAnimationFrame(loop);
}
requestAnimationFrame(loop);

// pointer handling (mouse/touch)
function startHold(e){
  if(bloomed) return;
  holding = true;
  growBtn.setAttribute('aria-pressed','true');
}
function stopHold(e){
  if(bloomed) return;
  holding = false;
  growBtn.setAttribute('aria-pressed','false');
}
function quickClick(e){
  if(bloomed) return;
  // small immediate step
  setGrowth(growth + 6 + Math.random()*3);
  // small micro burst of tiny particles near bud to give feedback
  const rect = scene.getBoundingClientRect();
  const bRect = plant.querySelector('.bud').getBoundingClientRect();
  const cx = bRect.left - rect.left + bRect.width/2;
  const cy = bRect.top - rect.top + bRect.height/2;
  spawnBurst(cx, cy, 6);
}

// attach events: support pointer events
plant.addEventListener('pointerdown', (e) => { e.preventDefault(); plant.setPointerCapture(e.pointerId); startHold(e); });
plant.addEventListener('pointerup', (e) => { try{ plant.releasePointerCapture(e.pointerId);}catch(_){} stopHold(e); quickClick(e); });
plant.addEventListener('pointercancel', (e) => { stopHold(e); });
plant.addEventListener('pointerleave', (e) => { /*stopHold(e);*/ });

growBtn.addEventListener('pointerdown', (e)=>{e.preventDefault(); startHold(e);});
growBtn.addEventListener('pointerup', (e)=>{ stopHold(e); quickClick(e);});
growBtn.addEventListener('pointercancel', stopHold);

// keyboard accessibility: press space/enter to quick click, hold with space?
growBtn.addEventListener('keydown', (e)=>{
  if(e.key === ' ' || e.key === 'Enter'){ e.preventDefault(); startHold(e); }
});
growBtn.addEventListener('keyup', (e)=>{
  if(e.key === ' ' || e.key === 'Enter'){ e.preventDefault(); stopHold(e); quickClick(e); }
});

// helper: if user click anywhere else of scene, allow quickClick on plant
scene.addEventListener('click', (e)=>{
  // allow quick click only if clicking on pot area
  // find approximate if they click inside pot rectangle
  const rect = pot.getBoundingClientRect();
  if(e.clientX >= rect.left && e.clientX <= rect.right && e.clientY >= rect.top-80 && e.clientY <= rect.bottom+40){
    quickClick(e);
  }
});

// initial draw
setGrowth(0);

// small auto-pulse to prompt the user
let pulse = true;
setInterval(()=>{
  if(!pulse || growth>0 || bloomed) return;
  plant.animate([{transform:'translateY(0) scale(1)'},{transform:'translateY(-6px) scale(1.02)'},{transform:'translateY(0) scale(1)'}],{duration:900,iterations:1,easing:'ease-out'});
}, 2500);

// small helper to spawn a tiny burst occasionally near bud when user clicks quickly
function tinyClickAtBud(){
  const rect = scene.getBoundingClientRect();
  const bRect = plant.querySelector('.bud').getBoundingClientRect();
  const cx = bRect.left - rect.left + bRect.width/2;
  const cy = bRect.top - rect.top + bRect.height/2;
  spawnBurst(cx, cy, 6);
}
</script>
</body>
</html>
